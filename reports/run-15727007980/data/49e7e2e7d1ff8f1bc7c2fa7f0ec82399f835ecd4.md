# Test info

- Name: Remove profile test
- Location: /home/runner/work/FRW-Extension/FRW-Extension/e2e/registration/login.test.ts:8:1

# Error details

```
Error: locator.click: Target page, context or browser has been closed
Call log:
  - waiting for getByRole('button', { name: 'Profile end' })

    at /home/runner/work/FRW-Extension/FRW-Extension/e2e/registration/login.test.ts:20:59
```

# Page snapshot

```yaml
- banner:
  - button "ðŸ¦":
    - paragraph: ðŸ¦
  - button "Lion 0xbd2f55be82df6d30":
    - text: Lion 0xbd2f55be82df6d30
    - img
  - button "notification": "7"
  - button "avatar"
- button
- heading "Settings" [level=1]
- list:
  - link "senderci senderci end":
    - /url: "#/dashboard/setting/account"
    - img "senderci"
    - text: senderci
    - img
- list:
  - link "Address":
    - /url: "#/dashboard/setting/addressbook"
    - button "Address":
      - img
      - text: Address
  - link "Account List":
    - /url: "#/dashboard/setting/wallet"
    - button "Account List":
      - img
      - text: Account List
- list:
  - link "Display Currency":
    - /url: "#/dashboard/setting/currency"
    - button "Display Currency":
      - img
      - text: Display Currency
      - img
  - separator
  - link "Backup":
    - /url: "#/dashboard/setting/backups"
    - button "Backup":
      - img
      - text: Backup
      - img
  - separator
  - link "Security":
    - /url: "#/dashboard/setting/changepassword"
    - button "Security":
      - img
      - text: Security
      - img
- list:
  - link "Try Our Mobile App":
    - /url: "#/dashboard/https://core.flow.com"
    - button "Try Our Mobile App":
      - img
      - text: Try Our Mobile App
      - button
      - button
  - separator
  - link "Developer Mode":
    - /url: "#/dashboard/setting/developerMode"
    - button "Developer Mode":
      - img
      - text: Developer Mode
      - img
  - separator
  - link "About":
    - /url: "#/dashboard/setting/about"
    - button "About":
      - img
      - text: About
      - img
- list:
  - link "Add new profile":
    - /url: "#/dashboard/setting"
    - button "Add new profile":
      - img
      - text: Add new profile
      - img
```

# Test source

```ts
   1 | import { fillInPassword, importSenderAccount, loginAsTestUser } from '../utils/helper';
   2 | import { test, expect, getAuth } from '../utils/loader';
   3 |
   4 | test('Login test', async ({ page, extensionId }) => {
   5 |   await loginAsTestUser({ page, extensionId });
   6 | });
   7 |
   8 | test('Remove profile test', async ({ page, extensionId }) => {
   9 |   const keysFile = await getAuth();
  10 |
  11 |   if (keysFile.password === '') {
  12 |     throw new Error('Password is empty in keys file');
  13 |   }
  14 |   await loginAsTestUser({ page, extensionId });
  15 |   await importSenderAccount({ page, extensionId });
  16 |
  17 |   await page.getByLabel('avatar').click();
  18 |   await page.getByLabel('avatar').click();
  19 |   await page.getByLabel('avatar').click();
> 20 |   await page.getByRole('button', { name: 'Profile end' }).click();
     |                                                           ^ Error: locator.click: Target page, context or browser has been closed
  21 |   await page.getByRole('button', { name: 'Remove Profile' }).click();
  22 |   await fillInPassword({ page, password: keysFile.password });
  23 |   await page.getByRole('button', { name: 'Remove' }).click();
  24 |
  25 |   // Wait for the unlock page to load
  26 |   await page.waitForURL(`chrome-extension://${extensionId}/index.html#/unlock`);
  27 |
  28 |   // Now login as the test user
  29 |   await loginAsTestUser({ page, extensionId });
  30 |   // Check that the sender account is not visible
  31 |   // switch to the correct account
  32 |   await page.getByTestId('account-menu-button').click();
  33 |   await page.getByRole('button', { name: 'close' }).click();
  34 |
  35 |   expect(await page.getByTestId('profile-item-nickname-sender').count()).toBe(0);
  36 | });
  37 |
```