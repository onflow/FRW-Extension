# Test info

- Name: EVM transactions
- Location: /home/runner/work/FRW-Extension/FRW-Extension/e2e/transaction/evm-transaction.test.ts:79:1

# Error details

```
Error: expect(locator).toBeVisible()

Locator: getByTestId(/^.*1f5e3b6ac4bd49629a86ed2023098c352d2c602c1568c9b72ca7489f4febc7e5.*$/).filter({ hasText: 'success' })
Expected: visible
Received: <element(s) not found>
Call log:
  - expect.toBeVisible with timeout 60000ms
  - waiting for getByTestId(/^.*1f5e3b6ac4bd49629a86ed2023098c352d2c602c1568c9b72ca7489f4febc7e5.*$/).filter({ hasText: 'success' })

    at checkSentAmount (/home/runner/work/FRW-Extension/FRW-Extension/e2e/utils/helper.ts:466:28)
    at map (/home/runner/work/FRW-Extension/FRW-Extension/e2e/transaction/evm-transaction.test.ts:153:13)
    at /home/runner/work/FRW-Extension/FRW-Extension/e2e/transaction/evm-transaction.test.ts:152:12
```

# Page snapshot

```yaml
- banner:
  - button "ðŸ‹":
    - paragraph: ðŸ‹
  - paragraph: ðŸ¨
  - button "development"
  - button "Lemon EVM 0x000000...1AEC842B":
    - text: Lemon EVM 0x000000...1AEC842B
    - img
  - button "notification": "7"
  - button "avatar"
- paragraph: $2.35USD
- button:
  - img
- paragraph: Send
- button:
  - img
- paragraph: Receive
- button:
  - img
- paragraph: Swap
- button:
  - img
- paragraph: Buy
- button:
  - img
- paragraph: Move
- tablist "full width tabs example":
  - tab "coins":
    - img
    - paragraph: coins
  - tab "NFTs":
    - img
    - paragraph: NFTs
  - tab "Activity" [selected]:
    - img
    - paragraph: Activity
- tabpanel:
  - listitem:
    - button "a few seconds ago":
      - img
      - paragraph
      - paragraph: a few seconds ago
      - paragraph
    - paragraph
    - paragraph: Executed
  - listitem:
    - button "a few seconds ago":
      - img
      - paragraph
      - paragraph: a few seconds ago
      - paragraph
    - paragraph
    - paragraph: Executed
  - listitem:
    - button "a minute ago":
      - img
      - paragraph
      - paragraph: a minute ago
      - paragraph
    - paragraph
    - paragraph: Executed
  - listitem:
    - button "a minute ago":
      - img
      - paragraph
      - paragraph: a minute ago
      - paragraph
    - paragraph
    - paragraph: Executed
  - listitem:
    - button "a minute ago":
      - img
      - paragraph
      - paragraph: a minute ago
      - paragraph
    - paragraph
    - paragraph: Executed
  - listitem:
    - button "a minute ago":
      - img
      - paragraph
      - paragraph: a minute ago
      - paragraph
    - paragraph
    - paragraph: Executed
  - listitem:
    - button "Receive FLOW 21 minutes ago From 0x0000...1221d883f5":
      - img
      - paragraph: Receive FLOW
      - paragraph: 21 minutes ago
      - paragraph: From 0x0000...1221d883f5
    - paragraph: "+0.12345678"
    - paragraph: success
  - listitem:
    - button "Send FLOW 21 minutes ago To 0x3918...d1312Bddb8":
      - img
      - paragraph: Send FLOW
      - paragraph: 21 minutes ago
      - paragraph: To 0x3918...d1312Bddb8
    - paragraph: "-0.00123456"
    - paragraph: success
  - listitem:
    - button "Receive FLOW 21 minutes ago From 0x0000...0000000000":
      - img
      - paragraph: Receive FLOW
      - paragraph: 21 minutes ago
      - paragraph: From 0x0000...0000000000
    - paragraph: "+0.00123456"
    - paragraph: success
  - listitem:
    - button "Send FLOW 21 minutes ago To 0x0000...1221d883F5":
      - img
      - paragraph: Send FLOW
      - paragraph: 21 minutes ago
      - paragraph: To 0x0000...1221d883F5
    - paragraph: "-0.00123456"
    - paragraph: success
  - listitem:
    - button "Receive FLOW 21 minutes ago From 0x0000...0000000000":
      - img
      - paragraph: Receive FLOW
      - paragraph: 21 minutes ago
      - paragraph: From 0x0000...0000000000
    - paragraph: "+0.00123456"
    - paragraph: success
  - listitem:
    - button "Receive FLOW 34 minutes ago From 0x0000...1221d883f5":
      - img
      - paragraph: Receive FLOW
      - paragraph: 34 minutes ago
      - paragraph: From 0x0000...1221d883f5
    - paragraph: "+0.12345678"
    - paragraph: success
  - listitem:
    - button "Receive FLOW 36 minutes ago From 0x0000...1221d883f5":
      - img
      - paragraph: Receive FLOW
      - paragraph: 36 minutes ago
      - paragraph: From 0x0000...1221d883f5
    - paragraph: "+0.12345678"
    - paragraph: success
  - listitem:
    - button "Send FLOW 36 minutes ago To 0x3918...d1312Bddb8":
      - img
      - paragraph: Send FLOW
      - paragraph: 36 minutes ago
      - paragraph: To 0x3918...d1312Bddb8
    - paragraph: "-0.00123456"
    - paragraph: success
  - listitem:
    - button "Receive FLOW 36 minutes ago From 0x0000...0000000000":
      - img
      - paragraph: Receive FLOW
      - paragraph: 36 minutes ago
      - paragraph: From 0x0000...0000000000
    - paragraph: "+0.00123456"
    - paragraph: success
  - listitem:
    - button "Send FLOW 37 minutes ago To 0x0000...1221d883F5":
      - img
      - paragraph: Send FLOW
      - paragraph: 37 minutes ago
      - paragraph: To 0x0000...1221d883F5
    - paragraph: "-0.00123456"
    - paragraph: success
  - listitem:
    - button "Receive FLOW 37 minutes ago From 0x0000...0000000000":
      - img
      - paragraph: Receive FLOW
      - paragraph: 37 minutes ago
      - paragraph: From 0x0000...0000000000
    - paragraph: "+0.00123456"
    - paragraph: success
  - listitem:
    - button "Receive FLOW 2 hours ago From 0x0000...1221d883f5":
      - img
      - paragraph: Receive FLOW
      - paragraph: 2 hours ago
      - paragraph: From 0x0000...1221d883f5
    - paragraph: "+0.12345678"
    - paragraph: success
  - listitem:
    - button "Send FLOW 2 hours ago To 0x3918...d1312Bddb8":
      - img
      - paragraph: Send FLOW
      - paragraph: 2 hours ago
      - paragraph: To 0x3918...d1312Bddb8
    - paragraph: "-0.00123456"
    - paragraph: success
  - listitem:
    - button "Receive FLOW 2 hours ago From 0x0000...0000000000":
      - img
      - paragraph: Receive FLOW
      - paragraph: 2 hours ago
      - paragraph: From 0x0000...0000000000
    - paragraph: "+0.00123456"
    - paragraph: success
  - listitem:
    - button "Send FLOW 2 hours ago To 0x0000...1221d883F5":
      - img
      - paragraph: Send FLOW
      - paragraph: 2 hours ago
      - paragraph: To 0x0000...1221d883F5
    - paragraph: "-0.00123456"
    - paragraph: success
  - listitem:
    - button "Receive FLOW 2 hours ago From 0x0000...0000000000":
      - img
      - paragraph: Receive FLOW
      - paragraph: 2 hours ago
      - paragraph: From 0x0000...0000000000
    - paragraph: "+0.00123456"
    - paragraph: success
  - listitem:
    - button "Receive FLOW 18 hours ago From 0x0000...1221d883f5":
      - img
      - paragraph: Receive FLOW
      - paragraph: 18 hours ago
      - paragraph: From 0x0000...1221d883f5
    - paragraph: "+0.12345678"
    - paragraph: success
  - listitem:
    - button "Receive FLOW 18 hours ago From 0x0000...1221d883f5":
      - img
      - paragraph: Receive FLOW
      - paragraph: 18 hours ago
      - paragraph: From 0x0000...1221d883f5
    - paragraph: "+0.12345678"
    - paragraph: success
  - listitem:
    - button "Send FLOW 18 hours ago To 0x3918...d1312Bddb8":
      - img
      - paragraph: Send FLOW
      - paragraph: 18 hours ago
      - paragraph: To 0x3918...d1312Bddb8
    - paragraph: "-0.00123456"
    - paragraph: success
  - listitem:
    - button "Receive FLOW 18 hours ago From 0x0000...0000000000":
      - img
      - paragraph: Receive FLOW
      - paragraph: 18 hours ago
      - paragraph: From 0x0000...0000000000
    - paragraph: "+0.00123456"
    - paragraph: success
  - listitem:
    - button "Send FLOW 18 hours ago To 0x0000...1221d883F5":
      - img
      - paragraph: Send FLOW
      - paragraph: 18 hours ago
      - paragraph: To 0x0000...1221d883F5
    - paragraph: "-0.00123456"
    - paragraph: success
  - listitem:
    - button "Receive FLOW 18 hours ago From 0x0000...0000000000":
      - img
      - paragraph: Receive FLOW
      - paragraph: 18 hours ago
      - paragraph: From 0x0000...0000000000
    - paragraph: "+0.00123456"
    - paragraph: success
  - listitem:
    - button "Send FLOW 18 hours ago To 0x3918...d1312Bddb8":
      - img
      - paragraph: Send FLOW
      - paragraph: 18 hours ago
      - paragraph: To 0x3918...d1312Bddb8
    - paragraph: "-0.00123456"
    - paragraph: success
  - listitem:
    - button "Receive FLOW 18 hours ago From 0x0000...0000000000":
      - img
      - paragraph: Receive FLOW
      - paragraph: 18 hours ago
      - paragraph: From 0x0000...0000000000
    - paragraph: "+0.00123456"
    - paragraph: success
  - listitem:
    - button "Receive FLOW 18 hours ago From 0x0000...1221d883f5":
      - img
      - paragraph: Receive FLOW
      - paragraph: 18 hours ago
      - paragraph: From 0x0000...1221d883f5
    - paragraph: "+0.12345678"
    - paragraph: success
  - listitem:
    - button "Send FLOW 18 hours ago To 0x0000...1221d883F5":
      - img
      - paragraph: Send FLOW
      - paragraph: 18 hours ago
      - paragraph: To 0x0000...1221d883F5
    - paragraph: "-0.00123456"
    - paragraph: success
  - listitem:
    - button "Receive FLOW 18 hours ago From 0x0000...0000000000":
      - img
      - paragraph: Receive FLOW
      - paragraph: 18 hours ago
      - paragraph: From 0x0000...0000000000
    - paragraph: "+0.00123456"
    - paragraph: success
  - listitem:
    - button "Receive FLOW 20 hours ago From 0x0000...1221d883f5":
      - img
      - paragraph: Receive FLOW
      - paragraph: 20 hours ago
      - paragraph: From 0x0000...1221d883f5
    - paragraph: "+0.12345678"
    - paragraph: success
  - listitem:
    - button "Receive FLOW 20 hours ago From 0x0000...1221d883f5":
      - img
      - paragraph: Receive FLOW
      - paragraph: 20 hours ago
      - paragraph: From 0x0000...1221d883f5
    - paragraph: "+0.12345678"
    - paragraph: success
  - listitem:
    - button "Send FLOW 20 hours ago To 0x0000...1221d883F5":
      - img
      - paragraph: Send FLOW
      - paragraph: 20 hours ago
      - paragraph: To 0x0000...1221d883F5
    - paragraph: "-0.12345678"
    - paragraph: success
  - listitem:
    - button "Send FLOW 20 hours ago To 0x3918...d1312Bddb8":
      - img
      - paragraph: Send FLOW
      - paragraph: 20 hours ago
      - paragraph: To 0x3918...d1312Bddb8
    - paragraph: "-0.00123456"
    - paragraph: success
  - listitem:
    - button "Receive FLOW 20 hours ago From 0x0000...0000000000":
      - img
      - paragraph: Receive FLOW
      - paragraph: 20 hours ago
      - paragraph: From 0x0000...0000000000
    - paragraph: "+0.00123456"
    - paragraph: success
  - listitem:
    - button "Send FLOW 20 hours ago To 0x0000...1221d883F5":
      - img
      - paragraph: Send FLOW
      - paragraph: 20 hours ago
      - paragraph: To 0x0000...1221d883F5
    - paragraph: "-0.00123456"
    - paragraph: success
  - listitem:
    - button "Receive FLOW 20 hours ago From 0x0000...0000000000":
      - img
      - paragraph: Receive FLOW
      - paragraph: 20 hours ago
      - paragraph: From 0x0000...0000000000
    - paragraph: "+0.00123456"
    - paragraph: success
  - listitem:
    - button "Send FLOW a day ago To 0x3918...d1312Bddb8":
      - img
      - paragraph: Send FLOW
      - paragraph: a day ago
      - paragraph: To 0x3918...d1312Bddb8
    - paragraph: "-0.00123456"
    - paragraph: success
  - listitem:
    - button "Receive FLOW a day ago From 0x0000...0000000000":
      - img
      - paragraph: Receive FLOW
      - paragraph: a day ago
      - paragraph: From 0x0000...0000000000
    - paragraph: "+0.00123456"
    - paragraph: success
  - listitem:
    - button "Receive FLOW a day ago From 0x0000...1221d883f5":
      - img
      - paragraph: Receive FLOW
      - paragraph: a day ago
      - paragraph: From 0x0000...1221d883f5
    - paragraph: "+0.12345678"
    - paragraph: success
  - listitem:
    - button "Send FLOW a day ago To 0x0000...1221d883F5":
      - img
      - paragraph: Send FLOW
      - paragraph: a day ago
      - paragraph: To 0x0000...1221d883F5
    - paragraph: "-0.00123456"
    - paragraph: success
  - listitem:
    - button "Receive FLOW a day ago From 0x0000...0000000000":
      - img
      - paragraph: Receive FLOW
      - paragraph: a day ago
      - paragraph: From 0x0000...0000000000
    - paragraph: "+0.00123456"
    - paragraph: success
  - listitem:
    - button "Send BETA a day ago To 0x3918...d1312Bddb8":
      - img
      - paragraph: Send BETA
      - paragraph: a day ago
      - paragraph: To 0x3918...d1312Bddb8
    - paragraph: "-0.001234567890123456"
    - paragraph: success
  - listitem:
    - button "Send FLOW a day ago To 0x3918...d1312Bddb8":
      - img
      - paragraph: Send FLOW
      - paragraph: a day ago
      - paragraph: To 0x3918...d1312Bddb8
    - paragraph: "-0.00123456"
    - paragraph: success
  - listitem:
    - button "Send FiatTokenProxy a day ago To 0x0000...5C27Ecab3B":
      - img
      - paragraph: Send FiatTokenProxy
      - paragraph: a day ago
      - paragraph: To 0x0000...5C27Ecab3B
    - paragraph: "-0.002468"
    - paragraph: success
  - listitem:
    - button "Send FLOW a day ago To 0x0000...0000000000":
      - img
      - paragraph: Send FLOW
      - paragraph: a day ago
      - paragraph: To 0x0000...0000000000
    - paragraph: "-0.00123456"
    - paragraph: success
  - listitem:
    - button "Send Increment Staked FLOW a day ago To 0x0000...1221d883F5":
      - img
      - paragraph: Send Increment Staked FLOW
      - paragraph: a day ago
      - paragraph: To 0x0000...1221d883F5
    - paragraph: "-0.00000112134354678"
    - paragraph: success
  - listitem:
    - button "Receive FLOW a day ago From 0x0000...1221d883f5":
      - img
      - paragraph: Receive FLOW
      - paragraph: a day ago
      - paragraph: From 0x0000...1221d883f5
    - paragraph: "+0.00123456"
    - paragraph: success
  - listitem:
    - button "Send FLOW a day ago To 0x0000...1221d883F5":
      - img
      - paragraph: Send FLOW
      - paragraph: a day ago
      - paragraph: To 0x0000...1221d883F5
    - paragraph: "-0.12345678"
    - paragraph: success
  - listitem:
    - button "Receive FLOW a day ago From 0x0000...1221d883f5":
      - img
      - paragraph: Receive FLOW
      - paragraph: a day ago
      - paragraph: From 0x0000...1221d883f5
    - paragraph: "+0.12345678"
    - paragraph: success
  - listitem:
    - button "Send BETA a day ago To 0x3918...d1312Bddb8":
      - img
      - paragraph: Send BETA
      - paragraph: a day ago
      - paragraph: To 0x3918...d1312Bddb8
    - paragraph: "-0.001234567890123456"
    - paragraph: success
  - listitem:
    - button "Send FLOW a day ago To 0x3918...d1312Bddb8":
      - img
      - paragraph: Send FLOW
      - paragraph: a day ago
      - paragraph: To 0x3918...d1312Bddb8
    - paragraph: "-0.00123456"
    - paragraph: success
  - listitem:
    - button "Send FiatTokenProxy a day ago To 0x0000...5C27Ecab3B":
      - img
      - paragraph: Send FiatTokenProxy
      - paragraph: a day ago
      - paragraph: To 0x0000...5C27Ecab3B
    - paragraph: "-0.002468"
    - paragraph: success
  - button "View more transactions"
```

# Test source

```ts
  366 |   });
  367 | };
  368 |
  369 | export const importReceiverAccount = async ({ page, extensionId }) => {
  370 |   await importAccountBySeedPhrase({
  371 |     page,
  372 |     extensionId,
  373 |     seedPhrase: process.env.TEST_SEED_PHRASE_RECEIVER,
  374 |     username: 'receiver',
  375 |     accountAddr: process.env.TEST_RECEIVER_ADDR,
  376 |   });
  377 | };
  378 |
  379 | export const getSenderCadenceAccount = ({ parallelIndex }) => {
  380 |   // If parallel index is 0, login to sender account, otherwise login to receiver account
  381 |   if (parallelIndex === 0) {
  382 |     // We've logged into the sender account, and we need to send tokens to the receiver account
  383 |     return process.env.TEST_SENDER_ADDR;
  384 |   } else {
  385 |     // We've logged into the receiver account, and we need to send tokens back to the sender account
  386 |     return process.env.TEST_RECEIVER_ADDR;
  387 |   }
  388 | };
  389 |
  390 | export const getReceiverCadenceAccount = ({ parallelIndex }) => {
  391 |   // If parallel index is 0, login to sender account, otherwise login to receiver account
  392 |   if (parallelIndex === 0) {
  393 |     // We've logged into the sender account, and we need to send tokens to the receiver account
  394 |     return process.env.TEST_RECEIVER_ADDR;
  395 |   } else {
  396 |     // We've logged into the receiver account, and we need to send tokens back to the sender account
  397 |     return process.env.TEST_SENDER_ADDR;
  398 |   }
  399 | };
  400 | export const getSenderEvmAccount = ({ parallelIndex }) => {
  401 |   // If parallel index is 0, login to sender account, otherwise login to receiver account
  402 |   if (parallelIndex === 0) {
  403 |     // We've logged into the sender account, and we need to send tokens to the receiver account
  404 |     return process.env.TEST_SENDER_EVM_ADDR;
  405 |   } else {
  406 |     // We've logged into the receiver account, and we need to send tokens back to the sender account
  407 |     return process.env.TEST_RECEIVER_EVM_ADDR;
  408 |   }
  409 | };
  410 | export const getReceiverEvmAccount = ({ parallelIndex }) => {
  411 |   // If parallel index is 0, login to sender account, otherwise login to receiver account
  412 |   if (parallelIndex === 0) {
  413 |     // We've logged into the sender account, and we need to send tokens to the receiver account
  414 |     return process.env.TEST_RECEIVER_EVM_ADDR;
  415 |   } else {
  416 |     // We've logged into the receiver account, and we need to send tokens back to the sender account
  417 |     return process.env.TEST_SENDER_EVM_ADDR;
  418 |   }
  419 | };
  420 |
  421 | export const loginToSenderOrReceiver = async ({ page, extensionId, parallelIndex }) => {
  422 |   // If parallel index is 0, login to sender account, otherwise login to receiver account
  423 |   if (parallelIndex === 0) {
  424 |     await loginToSenderAccount({ page, extensionId });
  425 |   } else {
  426 |     await loginToReceiverAccount({ page, extensionId });
  427 |   }
  428 | };
  429 |
  430 | export const switchToEvmAddress = async ({ page, address }) => {
  431 |   // Assume the user is on the dashboard page
  432 |   await page.getByTestId('account-menu-button').click();
  433 |   // switch to COA account
  434 |   await page
  435 |     .getByTestId(new RegExp(`evm-account-${address}`, 'i'))
  436 |     .first()
  437 |     .click();
  438 |   // get address
  439 |   await getCurrentAddress(page);
  440 | };
  441 |
  442 | export const switchToMainAccount = async ({ page, address }) => {
  443 |   // Assume the user is on the dashboard page
  444 |   await page.getByTestId('account-menu-button').click();
  445 |   // switch to another flow account
  446 |   await page
  447 |     .getByTestId(new RegExp(`main-account-${address}`, 'i'))
  448 |     .first()
  449 |     .click();
  450 |   // get address
  451 |   await getCurrentAddress(page);
  452 | };
  453 | const getActivityItemRegexp = (txId: string, ingoreFlowCharge = false) => {
  454 |   return new RegExp(`^.*${txId}.*${ingoreFlowCharge ? '(?<!FlowToken)' : ''}$`);
  455 | };
  456 |
  457 | export const checkSentAmount = async ({
  458 |   page,
  459 |   sealedText,
  460 |   amount,
  461 |   txId,
  462 |   ingoreFlowCharge = false,
  463 | }) => {
  464 |   const activityItemRegexp = getActivityItemRegexp(txId, ingoreFlowCharge);
  465 |   const sealedItem = page.getByTestId(activityItemRegexp).filter({ hasText: sealedText });
> 466 |   await expect(sealedItem).toBeVisible({
      |                            ^ Error: expect(locator).toBeVisible()
  467 |     timeout: 60_000,
  468 |   });
  469 |   await expect(
  470 |     page.getByTestId(activityItemRegexp).getByTestId(`token-balance-${amount}`)
  471 |   ).toBeVisible();
  472 | };
  473 |
  474 | export const waitForTransaction = async ({
  475 |   page,
  476 |   successtext = 'success',
  477 |   amount = '',
  478 |   ingoreFlowCharge = false,
  479 | }: {
  480 |   page: Page;
  481 |   successtext?: string | RegExp;
  482 |   amount?: string;
  483 |   ingoreFlowCharge?: boolean;
  484 | }) => {
  485 |   // Wait for the transaction to be completed
  486 |   await page.waitForURL(/.*dashboard\?activity=1.*/);
  487 |   const url = await page.url();
  488 |
  489 |   const txId = url.match(/[\?&]txId=(\w+)/i)?.[1];
  490 |
  491 |   expect(txId).toBeDefined();
  492 |
  493 |   if (!txId) {
  494 |     throw new Error('Transaction ID is not found');
  495 |   }
  496 |   const progressBar = page.getByRole('progressbar');
  497 |   await expect(progressBar).toBeVisible();
  498 |   // Get the pending item with the cadence txId that was put in the url and status is pending
  499 |
  500 |   const activityItemRegexp = getActivityItemRegexp(txId, ingoreFlowCharge);
  501 |   const pendingItem = page.getByTestId(activityItemRegexp).filter({ hasText: 'Pending' });
  502 |
  503 |   await expect(pendingItem).toBeVisible({
  504 |     timeout: 60_000,
  505 |   });
  506 |   /// await expect(progressBar).not.toBeVisible({ timeout: 60_000 });
  507 |
  508 |   // Get the executed item with the cadence txId that was put in the url and status is success
  509 |   const executedItem = page.getByTestId(activityItemRegexp).filter({ hasText: successtext });
  510 |
  511 |   await expect(executedItem).toBeVisible({
  512 |     timeout: 60_000,
  513 |   });
  514 |
  515 |   if (amount) {
  516 |     await expect(
  517 |       page.getByTestId(activityItemRegexp).getByTestId(`token-balance-${amount}`)
  518 |     ).toBeVisible();
  519 |   }
  520 |
  521 |   return txId;
  522 | };
  523 |
```