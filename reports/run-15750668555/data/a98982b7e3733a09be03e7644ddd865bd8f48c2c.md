# Test info

- Name: Import sender and receiver accounts
- Location: /home/runner/work/FRW-Extension/FRW-Extension/e2e/transaction/transaction.setup.ts:4:1

# Error details

```
Error: Timed out 10000ms waiting for expect(locator).toBeVisible()

Locator: getByRole('button', { name: 'Connect and Back up' })
Expected: visible
Received: <element(s) not found>
Call log:
  - expect.toBeVisible with timeout 10000ms
  - waiting for getByRole('button', { name: 'Connect and Back up' })

    at importAccountBySeedPhrase (/home/runner/work/FRW-Extension/FRW-Extension/e2e/utils/helper.ts:303:75)
    at importSenderAccount (/home/runner/work/FRW-Extension/FRW-Extension/e2e/utils/helper.ts:325:3)
    at /home/runner/work/FRW-Extension/FRW-Extension/e2e/transaction/transaction.setup.ts:7:3
```

# Page snapshot

```yaml
- button "Need Help?":
  - link "Need Help?":
    - /url: https://wallet.flow.com/contact
    - paragraph: Need Help?
- button:
  - img
- paragraph: STEP 1/6
- heading "Import Profile" [level=4]
- paragraph: From Recovery Phrase, Keystore or Private Key
- tablist "simple tabs example":
  - tab "Google Drive" [selected]
  - tab "Keystore"
  - tab "Recovery phrase"
  - tab "Private key"
  - tab "Mobile app":
    - img
    - text: Mobile app
- tabpanel:
  - img
  - paragraph: Restore Backup from Google Drive
  - button "Connect":
    - paragraph: Connect
```

# Test source

```ts
  203 |   });
  204 |
  205 |   // await unlockBtn.isEnabled();
  206 |   await page.goto(`chrome-extension://${extensionId}/index.html#/dashboard`);
  207 |
  208 |   // get address
  209 |
  210 |   const flowAddr = await getCurrentAddress(page);
  211 |
  212 |   // save keys and pwd to keys file
  213 |   return {
  214 |     privateKey: clipboardText,
  215 |     password: password,
  216 |     addr: flowAddr,
  217 |   };
  218 | };
  219 |
  220 | export const registerTestUser = async ({ page, extensionId }) => {
  221 |   const username = `testuser${String.fromCharCode(
  222 |     ...Array(4)
  223 |       .fill(0)
  224 |       .map(() => Math.floor(Math.random() * 26) + 97)
  225 |   )}`;
  226 |   const password = process.env.TEST_PASSWORD;
  227 |   if (!password) {
  228 |     throw new Error('TEST_PASSWORD is not set');
  229 |   }
  230 |
  231 |   const {
  232 |     privateKey,
  233 |     password: pwd,
  234 |     addr,
  235 |   } = await registerAccount({ page, extensionId, username, password });
  236 |
  237 |   await saveAuth({
  238 |     privateKey,
  239 |     password: pwd,
  240 |     addr,
  241 |     nickname: username,
  242 |   });
  243 | };
  244 |
  245 | export const importAccountBySeedPhrase = async ({
  246 |   page,
  247 |   extensionId,
  248 |   seedPhrase,
  249 |   username,
  250 |   accountAddr = '',
  251 | }) => {
  252 |   const password = process.env.TEST_PASSWORD;
  253 |   if (!password) {
  254 |     throw new Error('TEST_PASSWORD is not set');
  255 |   }
  256 |   if (page.url().includes('dashboard')) {
  257 |     // Wait for the dashboard page to be fully loaded
  258 |     await page.waitForURL(/.*\/dashboard.*/);
  259 |
  260 |     // We're already logged in so we need to click import profile
  261 |     await page.getByTestId('account-menu-button').click();
  262 |     await page.getByTestId('switch-profile-button').click();
  263 |     await page.getByTestId('recover-profile-button').click();
  264 |     // Close all pages except the current page (the extension opens them in the background)
  265 |     await closeOpenedPages(page);
  266 |   }
  267 |
  268 |   // Go to the import page
  269 |   await page.goto(`chrome-extension://${extensionId}/index.html#/welcome/accountimport`);
  270 |
  271 |   // Close all pages except the current page (the extension opens them in the background)
  272 |   await closeOpenedPages(page);
  273 |
  274 |   await page.getByRole('tab', { name: 'Recovery Phrase' }).click();
  275 |   await page.getByPlaceholder('Import 12 or 24 words split').click();
  276 |
  277 |   await page.getByPlaceholder('Import 12 or 24 words split').fill(seedPhrase);
  278 |
  279 |   await page.getByRole('button', { name: 'Import' }).click();
  280 |   // We need to wait for the next step to be visible
  281 |
  282 |   await expect(page.getByRole('button', { name: 'Import' })).not.toBeVisible();
  283 |
  284 |   const step = await page.getByText('STEP').textContent();
  285 |
  286 |   if (step.includes('4')) {
  287 |     // We've already imported the account before
  288 |     await fillInPassword({ page, password });
  289 |
  290 |     await page.getByRole('button', { name: 'Login' }).click();
  291 |     // await page.getByRole('button', { name: 'Login' }).click();
  292 |   } else if (step.includes('2')) {
  293 |     // We haven't imported the account before
  294 |     await page.getByPlaceholder('Username').fill(username);
  295 |     await page.getByRole('button', { name: 'Next' }).click();
  296 |
  297 |     await fillInPassword({ page, password });
  298 |
  299 |     await page.getByRole('button', { name: /Login|Register/i }).click();
  300 |   }
  301 |
  302 |   // Wait for the Google Drive backup text to be visible
> 303 |   await expect(page.getByRole('button', { name: 'Connect and Back up' })).toBeVisible({
      |                                                                           ^ Error: Timed out 10000ms waiting for expect(locator).toBeVisible()
  304 |     timeout: 10_000,
  305 |   });
  306 |
  307 |   await page.goto(`chrome-extension://${extensionId}/index.html#/dashboard`);
  308 |   await page.waitForURL(/.*\/dashboard.*/);
  309 |
  310 |   // Wait for the account address to be visible
  311 |   let flowAddr = await getCurrentAddress(page);
  312 |
  313 |   if (accountAddr && flowAddr !== accountAddr) {
  314 |     await switchToMainAccount({ page, address: accountAddr });
  315 |     flowAddr = await getCurrentAddress(page);
  316 |   }
  317 |   if (accountAddr && flowAddr !== accountAddr) {
  318 |     throw new Error('Account address does not match');
  319 |   }
  320 |
  321 |   return flowAddr;
  322 | };
  323 |
  324 | export const importSenderAccount = async ({ page, extensionId }) => {
  325 |   await importAccountBySeedPhrase({
  326 |     page,
  327 |     extensionId,
  328 |     seedPhrase: process.env.TEST_SEED_PHRASE_SENDER,
  329 |     username: 'sender',
  330 |     accountAddr: process.env.TEST_SENDER_ADDR,
  331 |   });
  332 | };
  333 |
  334 | export const loginToSenderAccount = async ({ page, extensionId }) => {
  335 |   if (!process.env.TEST_SENDER_ADDR) {
  336 |     throw new Error('TEST_SENDER_ADDR is not set');
  337 |   }
  338 |
  339 |   if (!process.env.TEST_PASSWORD) {
  340 |     throw new Error('TEST_PASSWORD is not set');
  341 |   }
  342 |
  343 |   await loginToExtensionAccount({
  344 |     page,
  345 |     extensionId,
  346 |     addr: process.env.TEST_SENDER_ADDR!,
  347 |     password: process.env.TEST_PASSWORD!,
  348 |     nickname: process.env.TEST_SENDER_NICKNAME!,
  349 |   });
  350 | };
  351 |
  352 | export const loginToReceiverAccount = async ({ page, extensionId }) => {
  353 |   if (!process.env.TEST_RECEIVER_ADDR) {
  354 |     throw new Error('TEST_RECEIVER_ADDR is not set');
  355 |   }
  356 |
  357 |   if (!process.env.TEST_PASSWORD) {
  358 |     throw new Error('TEST_PASSWORD is not set');
  359 |   }
  360 |
  361 |   await loginToExtensionAccount({
  362 |     page,
  363 |     extensionId,
  364 |     addr: process.env.TEST_RECEIVER_ADDR!,
  365 |     password: process.env.TEST_PASSWORD!,
  366 |     nickname: process.env.TEST_RECEIVER_NICKNAME!,
  367 |   });
  368 | };
  369 |
  370 | export const importReceiverAccount = async ({ page, extensionId }) => {
  371 |   await importAccountBySeedPhrase({
  372 |     page,
  373 |     extensionId,
  374 |     seedPhrase: process.env.TEST_SEED_PHRASE_RECEIVER,
  375 |     username: 'receiver',
  376 |     accountAddr: process.env.TEST_RECEIVER_ADDR,
  377 |   });
  378 | };
  379 |
  380 | export const getSenderCadenceAccount = ({ parallelIndex }) => {
  381 |   // If parallel index is 0, login to sender account, otherwise login to receiver account
  382 |   if (parallelIndex === 0) {
  383 |     // We've logged into the sender account, and we need to send tokens to the receiver account
  384 |     return process.env.TEST_SENDER_ADDR;
  385 |   } else {
  386 |     // We've logged into the receiver account, and we need to send tokens back to the sender account
  387 |     return process.env.TEST_RECEIVER_ADDR;
  388 |   }
  389 | };
  390 |
  391 | export const getReceiverCadenceAccount = ({ parallelIndex }) => {
  392 |   // If parallel index is 0, login to sender account, otherwise login to receiver account
  393 |   if (parallelIndex === 0) {
  394 |     // We've logged into the sender account, and we need to send tokens to the receiver account
  395 |     return process.env.TEST_RECEIVER_ADDR;
  396 |   } else {
  397 |     // We've logged into the receiver account, and we need to send tokens back to the sender account
  398 |     return process.env.TEST_SENDER_ADDR;
  399 |   }
  400 | };
  401 | export const getSenderEvmAccount = ({ parallelIndex }) => {
  402 |   // If parallel index is 0, login to sender account, otherwise login to receiver account
  403 |   if (parallelIndex === 0) {
```